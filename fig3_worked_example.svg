<?xml version="1.0" encoding="utf-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
     width="496.8pt" height="380pt" viewBox="0 0 620 475">
  <defs>
    <style type="text/css">
      .node-honest { fill: #3366CC; }
      .node-sybil  { fill: #CC3333; }
      .node-genesis { fill: #444444; }
      .edge-honest  { stroke: #3366CC; fill: none; stroke-width: 1.2; }
      .edge-backbone { stroke: #3366CC; fill: none; stroke-width: 3.0; }
      .edge-sybil   { stroke: #CC3333; fill: none; stroke-width: 1.2; }
      .edge-conflict { stroke: #888888; fill: none; stroke-width: 1.5; stroke-dasharray: 6,4; }
      .edge-genesis  { stroke: #444444; fill: none; stroke-width: 1.2; }
      .label-honest { fill: #3366CC; font-family: "Times New Roman", serif; font-size: 14px; font-style: italic; }
      .label-sybil  { fill: #CC3333; font-family: "Times New Roman", serif; font-size: 14px; font-style: italic; }
      .label-genesis { fill: #444444; font-family: "Times New Roman", serif; font-size: 14px; font-weight: bold; }
      .kappa-label  { font-family: "Times New Roman", serif; font-size: 10px; }
      .kappa-pos    { fill: #006600; }
      .kappa-zero   { fill: #336699; }
      .kappa-neg    { fill: #666666; }
      .kappa-sybil  { fill: #CC3333; }
      .legend-text  { font-family: "Times New Roman", serif; font-size: 11px; fill: #333333; }
      .conflict-label { font-family: "Times New Roman", serif; font-size: 10px; fill: #888888; font-style: italic; }
    </style>
    <marker id="arrow-honest" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="none" stroke="#3366CC" stroke-width="1"/>
    </marker>
    <marker id="arrow-sybil" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="none" stroke="#CC3333" stroke-width="1"/>
    </marker>
    <marker id="arrow-genesis" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="none" stroke="#444444" stroke-width="1"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="620" height="475" fill="#ffffff"/>

  <!-- ============================================================ -->
  <!-- NODE POSITIONS                                                -->
  <!-- Genesis: (310, 30)                                            -->
  <!-- Honest side (left):                                           -->
  <!--   H1: (170, 95)                                               -->
  <!--   H2: (110, 170)                                              -->
  <!--   H3: (220, 170)                                              -->
  <!--   H4: (60,  255)                                              -->
  <!--   H5: (150, 255)                                              -->
  <!--   H6: (240, 255)                                              -->
  <!--   H7: (105, 335)                                              -->
  <!-- Sybil side (right):                                           -->
  <!--   A1: (450, 95)                                               -->
  <!--   S1: (380, 170)  S2: (450, 170)  S3: (520, 170)             -->
  <!--   S4: (380, 255)  S5: (450, 255)  S6: (520, 255)             -->
  <!-- ============================================================ -->

  <!-- ============ EDGES ============ -->

  <!-- Genesis -> H1 -->
  <line x1="310" y1="42" x2="175" y2="83" class="edge-genesis" marker-end="url(#arrow-genesis)"/>

  <!-- Genesis -> A1 -->
  <line x1="310" y1="42" x2="445" y2="83" class="edge-genesis" marker-end="url(#arrow-genesis)"/>

  <!-- === HONEST EDGES === -->

  <!-- H1 -> H2 (kappa = 0.0) -->
  <line x1="164" y1="107" x2="115" y2="158" class="edge-honest" marker-end="url(#arrow-honest)"/>
  <rect x="113" y="118" width="34" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="130" y="129" text-anchor="middle" class="kappa-label kappa-zero">0.0</text>

  <!-- H1 -> H3 (kappa = -0.33) -->
  <line x1="176" y1="107" x2="215" y2="158" class="edge-honest" marker-end="url(#arrow-honest)"/>
  <rect x="178" y="118" width="44" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="200" y="129" text-anchor="middle" class="kappa-label kappa-neg">-0.33</text>

  <!-- H2 -> H3 BACKBONE (kappa = +0.33) THICK highlighted edge -->
  <line x1="122" y1="176" x2="208" y2="176" class="edge-backbone" marker-end="url(#arrow-honest)"/>
  <!-- Backbone highlight background -->
  <rect x="139" y="157" width="52" height="16" rx="3" fill="#e6ffe6" fill-opacity="0.9" stroke="#006600" stroke-width="0.5"/>
  <text x="165" y="169" text-anchor="middle" class="kappa-label kappa-pos" font-weight="bold" font-size="11px">+0.33</text>

  <!-- H2 -> H4 (kappa = -0.5) -->
  <line x1="104" y1="182" x2="66" y2="243" class="edge-honest" marker-end="url(#arrow-honest)"/>
  <rect x="58" y="200" width="38" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="77" y="211" text-anchor="middle" class="kappa-label kappa-neg">-0.5</text>

  <!-- H2 -> H5 (kappa = -0.5) -->
  <line x1="112" y1="182" x2="148" y2="243" class="edge-honest" marker-end="url(#arrow-honest)"/>

  <!-- H2 -> H6 (kappa = -0.5) -->
  <line x1="118" y1="182" x2="234" y2="243" class="edge-honest" marker-end="url(#arrow-honest)"/>

  <!-- H3 -> H4 (kappa = 0.0) -->
  <line x1="212" y1="182" x2="68" y2="243" class="edge-honest" marker-end="url(#arrow-honest)"/>

  <!-- H3 -> H5 (kappa = 0.0) -->
  <line x1="216" y1="182" x2="154" y2="243" class="edge-honest" marker-end="url(#arrow-honest)"/>

  <!-- H3 -> H6 (kappa = 0.0) -->
  <line x1="226" y1="182" x2="240" y2="243" class="edge-honest" marker-end="url(#arrow-honest)"/>
  <rect x="233" y="200" width="34" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="250" y="211" text-anchor="middle" class="kappa-label kappa-zero">0.0</text>

  <!-- H4 -> H7 (kappa = -0.2) -->
  <line x1="62" y1="267" x2="100" y2="323" class="edge-honest" marker-end="url(#arrow-honest)"/>
  <rect x="55" y="283" width="38" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="74" y="294" text-anchor="middle" class="kappa-label kappa-neg">-0.2</text>

  <!-- H5 -> H7 (kappa = -0.2) -->
  <line x1="148" y1="267" x2="112" y2="323" class="edge-honest" marker-end="url(#arrow-honest)"/>
  <rect x="119" y="283" width="38" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="138" y="294" text-anchor="middle" class="kappa-label kappa-neg">-0.2</text>

  <!-- === SYBIL EDGES === -->

  <!-- A1 -> S1 (kappa = 0.0, boundary) -->
  <line x1="444" y1="107" x2="385" y2="158" class="edge-sybil" marker-end="url(#arrow-sybil)"/>
  <rect x="393" y="118" width="34" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="410" y="129" text-anchor="middle" class="kappa-label kappa-zero">0.0</text>

  <!-- A1 -> S2 (kappa = 0.0, boundary) -->
  <line x1="450" y1="107" x2="450" y2="158" class="edge-sybil" marker-end="url(#arrow-sybil)"/>
  <rect x="453" y="118" width="34" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="470" y="129" text-anchor="middle" class="kappa-label kappa-zero">0.0</text>

  <!-- A1 -> S3 (kappa = 0.0, boundary) -->
  <line x1="456" y1="107" x2="515" y2="158" class="edge-sybil" marker-end="url(#arrow-sybil)"/>
  <rect x="491" y="118" width="34" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="508" y="129" text-anchor="middle" class="kappa-label kappa-zero">0.0</text>

  <!-- S1 -> S4 (kappa = -0.33, internal) -->
  <line x1="380" y1="182" x2="380" y2="243" class="edge-sybil" marker-end="url(#arrow-sybil)"/>
  <rect x="383" y="200" width="44" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="405" y="211" text-anchor="middle" class="kappa-label kappa-sybil">-0.33</text>

  <!-- S2 -> S5 (kappa = -0.33, internal) -->
  <line x1="450" y1="182" x2="450" y2="243" class="edge-sybil" marker-end="url(#arrow-sybil)"/>
  <rect x="453" y="200" width="44" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="475" y="211" text-anchor="middle" class="kappa-label kappa-sybil">-0.33</text>

  <!-- S3 -> S6 (kappa = -0.33, internal) -->
  <line x1="520" y1="182" x2="520" y2="243" class="edge-sybil" marker-end="url(#arrow-sybil)"/>
  <rect x="523" y="200" width="44" height="14" rx="2" fill="white" fill-opacity="0.85"/>
  <text x="545" y="211" text-anchor="middle" class="kappa-label kappa-sybil">-0.33</text>

  <!-- === CONFLICT (double-spend) dashed line between H1 and A1 === -->
  <line x1="185" y1="95" x2="435" y2="95" class="edge-conflict"/>
  <rect x="270" y="79" width="80" height="16" rx="3" fill="white" fill-opacity="0.9"/>
  <text x="310" y="91" text-anchor="middle" class="conflict-label">double-spend</text>

  <!-- ============ NODES (circles + labels) ============ -->

  <!-- Genesis -->
  <circle cx="310" cy="30" r="14" class="node-genesis" fill-opacity="0.15" stroke="#444444" stroke-width="1.5"/>
  <text x="310" y="35" text-anchor="middle" class="label-genesis" font-size="13px">G</text>

  <!-- H1 -->
  <circle cx="170" cy="95" r="13" class="node-honest" fill-opacity="0.15" stroke="#3366CC" stroke-width="1.5"/>
  <text x="170" y="99" text-anchor="middle" class="label-honest">H<tspan baseline-shift="sub" font-size="10px">1</tspan></text>

  <!-- H2 -->
  <circle cx="110" cy="170" r="13" class="node-honest" fill-opacity="0.15" stroke="#3366CC" stroke-width="1.5"/>
  <text x="110" y="174" text-anchor="middle" class="label-honest">H<tspan baseline-shift="sub" font-size="10px">2</tspan></text>

  <!-- H3 -->
  <circle cx="220" cy="170" r="13" class="node-honest" fill-opacity="0.15" stroke="#3366CC" stroke-width="1.5"/>
  <text x="220" y="174" text-anchor="middle" class="label-honest">H<tspan baseline-shift="sub" font-size="10px">3</tspan></text>

  <!-- H4 -->
  <circle cx="60" cy="255" r="13" class="node-honest" fill-opacity="0.15" stroke="#3366CC" stroke-width="1.5"/>
  <text x="60" y="259" text-anchor="middle" class="label-honest">H<tspan baseline-shift="sub" font-size="10px">4</tspan></text>

  <!-- H5 -->
  <circle cx="150" cy="255" r="13" class="node-honest" fill-opacity="0.15" stroke="#3366CC" stroke-width="1.5"/>
  <text x="150" y="259" text-anchor="middle" class="label-honest">H<tspan baseline-shift="sub" font-size="10px">5</tspan></text>

  <!-- H6 -->
  <circle cx="240" cy="255" r="13" class="node-honest" fill-opacity="0.15" stroke="#3366CC" stroke-width="1.5"/>
  <text x="240" y="259" text-anchor="middle" class="label-honest">H<tspan baseline-shift="sub" font-size="10px">6</tspan></text>

  <!-- H7 -->
  <circle cx="105" cy="335" r="13" class="node-honest" fill-opacity="0.15" stroke="#3366CC" stroke-width="1.5"/>
  <text x="105" y="339" text-anchor="middle" class="label-honest">H<tspan baseline-shift="sub" font-size="10px">7</tspan></text>

  <!-- A1 -->
  <circle cx="450" cy="95" r="13" class="node-sybil" fill-opacity="0.15" stroke="#CC3333" stroke-width="1.5"/>
  <text x="450" y="99" text-anchor="middle" class="label-sybil">A<tspan baseline-shift="sub" font-size="10px">1</tspan></text>

  <!-- S1 -->
  <circle cx="380" cy="170" r="13" class="node-sybil" fill-opacity="0.15" stroke="#CC3333" stroke-width="1.5"/>
  <text x="380" y="174" text-anchor="middle" class="label-sybil">S<tspan baseline-shift="sub" font-size="10px">1</tspan></text>

  <!-- S2 -->
  <circle cx="450" cy="170" r="13" class="node-sybil" fill-opacity="0.15" stroke="#CC3333" stroke-width="1.5"/>
  <text x="450" y="174" text-anchor="middle" class="label-sybil">S<tspan baseline-shift="sub" font-size="10px">2</tspan></text>

  <!-- S3 -->
  <circle cx="520" cy="170" r="13" class="node-sybil" fill-opacity="0.15" stroke="#CC3333" stroke-width="1.5"/>
  <text x="520" y="174" text-anchor="middle" class="label-sybil">S<tspan baseline-shift="sub" font-size="10px">3</tspan></text>

  <!-- S4 -->
  <circle cx="380" cy="255" r="13" class="node-sybil" fill-opacity="0.15" stroke="#CC3333" stroke-width="1.5"/>
  <text x="380" y="259" text-anchor="middle" class="label-sybil">S<tspan baseline-shift="sub" font-size="10px">4</tspan></text>

  <!-- S5 -->
  <circle cx="450" cy="255" r="13" class="node-sybil" fill-opacity="0.15" stroke="#CC3333" stroke-width="1.5"/>
  <text x="450" y="259" text-anchor="middle" class="label-sybil">S<tspan baseline-shift="sub" font-size="10px">5</tspan></text>

  <!-- S6 -->
  <circle cx="520" cy="255" r="13" class="node-sybil" fill-opacity="0.15" stroke="#CC3333" stroke-width="1.5"/>
  <text x="520" y="259" text-anchor="middle" class="label-sybil">S<tspan baseline-shift="sub" font-size="10px">6</tspan></text>

  <!-- ============ MULTI-PARENT ANNOTATIONS ============ -->
  <!-- Small annotation near H3 showing "parents: H1, H2" -->
  <text x="220" y="153" text-anchor="middle" font-family="Times New Roman, serif" font-size="8px" fill="#3366CC" font-style="italic">2 parents</text>

  <!-- Small annotation near H4, H5, H6 showing "parents: H2, H3" -->
  <text x="60" y="278" text-anchor="middle" font-family="Times New Roman, serif" font-size="8px" fill="#3366CC" font-style="italic">2 parents</text>
  <text x="150" y="278" text-anchor="middle" font-family="Times New Roman, serif" font-size="8px" fill="#3366CC" font-style="italic">2 parents</text>
  <text x="240" y="278" text-anchor="middle" font-family="Times New Roman, serif" font-size="8px" fill="#3366CC" font-style="italic">2 parents</text>

  <!-- Small annotation near H7 showing "parents: H4, H5" -->
  <text x="105" y="358" text-anchor="middle" font-family="Times New Roman, serif" font-size="8px" fill="#3366CC" font-style="italic">2 parents</text>

  <!-- ============ REGION LABELS ============ -->
  <text x="150" y="395" text-anchor="middle" font-family="Times New Roman, serif" font-size="13px" fill="#3366CC" font-weight="bold">Honest Network</text>
  <text x="150" y="410" text-anchor="middle" font-family="Times New Roman, serif" font-size="11px" fill="#3366CC">(dense, multi-parent)</text>

  <text x="450" y="310" text-anchor="middle" font-family="Times New Roman, serif" font-size="13px" fill="#CC3333" font-weight="bold">Sybil Cluster</text>
  <text x="450" y="325" text-anchor="middle" font-family="Times New Roman, serif" font-size="11px" fill="#CC3333">(pure tree, no overlap)</text>

  <!-- ============ LEGEND ============ -->
  <rect x="150" y="435" width="320" height="30" rx="4" fill="none" stroke="#cccccc" stroke-width="0.5"/>

  <!-- Blue = Honest -->
  <line x1="160" y1="452" x2="185" y2="452" stroke="#3366CC" stroke-width="2"/>
  <circle cx="172" cy="452" r="4" fill="#3366CC" fill-opacity="0.3" stroke="#3366CC" stroke-width="1"/>
  <text x="190" y="456" class="legend-text">Honest</text>

  <!-- Red = Sybil -->
  <line x1="245" y1="452" x2="270" y2="452" stroke="#CC3333" stroke-width="2"/>
  <circle cx="257" cy="452" r="4" fill="#CC3333" fill-opacity="0.3" stroke="#CC3333" stroke-width="1"/>
  <text x="275" y="456" class="legend-text">Sybil</text>

  <!-- Dashed = Conflict -->
  <line x1="320" y1="452" x2="355" y2="452" stroke="#888888" stroke-width="1.5" stroke-dasharray="6,4"/>
  <text x="360" y="456" class="legend-text">Conflict</text>

  <!-- Thick = Backbone -->
  <line x1="405" y1="452" x2="430" y2="452" stroke="#3366CC" stroke-width="3"/>
  <text x="435" y="456" class="legend-text">Backbone</text>

</svg>
